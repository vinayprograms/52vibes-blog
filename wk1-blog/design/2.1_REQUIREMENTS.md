# REQUIREMENTS

This document specifies formal product requirements for the 52vibes Blog Platform. Requirements are derived from customer needs documented in `1.1_NEEDS.md` and are structured for implementation by development teams.

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119.

---

## PRODUCTS

1. **Blog Platform** — A static website built with Hugo, deployed to Cloudflare Pages, providing content presentation, navigation, and discovery features for 52 weekly blog posts, monthly/quarterly reports, and supporting pages.

2. **crush-export** — A command-line utility that processes AI agent session data from `.crush/crush.db` SQLite database and generates wiki-ready markdown documents with structured metadata.

3. **Session Log Synchronization** — An automated GitHub Actions workflow that publishes session logs to the GitHub Wiki, maintaining separation from the main blog build process.

### Cross-Cutting Concerns

In addition to product-specific requirements, this document includes:

- **Deployment & Infrastructure (DI)** — Build system, local development, and production deployment requirements.
- **Non-Functional Requirements (NF)** — Performance, availability, scalability, and caching requirements.
- **Security Requirements (SC)** — Transport security, CSP, security headers, and third-party resource policies.

---

## PROJECT THEMES

The 52vibes project is organized into four quarterly themes. The system MUST associate each weekly blog post with the appropriate theme based on week number.

| Quarter | Weeks | Theme | Description |
|---------|-------|-------|-------------|
| Q1 | 1–13 | Agentic Infrastructure | Building foundational tools and frameworks for AI agent collaboration |
| Q2 | 14–26 | Production Tools | Real-world tools that push agent limits in practical settings |
| Q3 | 27–39 | Complex Workflows | Multi-step, multi-stakeholder challenges and human-in-the-loop systems |
| Q4 | 40–52 | Synthesis & Edge Cases | Edge case exploration, meta-analysis, and final reporting |

---

### Blog Platform

The Blog Platform is a static website providing content presentation, navigation, and discovery features for the 52vibes project documentation.

#### SPECIFICATIONS

##### Hosting and Deployment

* **BP001** - The system SHALL deploy the blog to `https://52vibes.dev/blog` as the canonical blog index URL.
* **BP002** - The system SHALL use Cloudflare Pages as the hosting platform.
* **BP003** - The system SHALL trigger automatic deployment upon push to the main branch of the source repository.
* **BP004** - Deployments MUST complete and propagate to the CDN within 5 minutes of push.

##### Performance and Compatibility

* **BP005** - All pages MUST achieve a Lighthouse performance score of 95 or higher under standard mobile testing conditions.
* **BP006** - All core functionality including content reading, page navigation, and site structure viewing MUST function without JavaScript enabled.
* **BP007** - The layout MUST render correctly on viewports ranging from 320px to 2560px width.
* **BP008** - The layout MUST adapt responsively to desktop (≥1024px), tablet (768px–1023px), and mobile (less than 768px) viewport classifications.
* **BP009** - The blog MUST be readable and navigable using text-based CLI browsers including lynx, w3m, and links.
* **BP010** - All text content MUST be accessible in CLI browsers without rendering artifacts or missing information.
* **BP011** - All navigation links MUST function correctly in CLI browsers.

##### Visual Design

* **BP012** - The visual design SHALL employ a terminal/tmux-inspired aesthetic featuring top and bottom status bars with bordered content areas.
* **BP013** - All structural borders and frames MUST be rendered using CSS border properties, not ASCII box-drawing characters.
* **BP014** - The system SHALL implement both dark and light color themes based on the Gruvbox color palette.
* **BP015** - Dark theme MUST use background color `#1d2021` (or approved Gruvbox dark variant) with light foreground text.
* **BP016** - Light theme MUST use background color `#fbf1c7` (or approved Gruvbox light variant) with dark foreground text.
* **BP017** - Theme selection MUST respect the user's system color scheme preference by default.
* **BP018** - The system SHALL provide a visible toggle control allowing users to override the default theme selection.
* **BP019** - Theme toggle functionality MAY use embedded JavaScript for state persistence across page loads.
* **BP020** - Theme toggle functionality MAY degrade gracefully in CLI browsers where theme selection is not applicable.
* **BP021** - Body text and headings MUST use IBM Plex Sans font family.
* **BP022** - Code blocks and monospace content MUST use JetBrains Mono font family.
* **BP023** - The system SHALL load web fonts with appropriate fallback font stacks.

##### Branding

* **BP024** - All pages MUST display "52 VIBES" branding prominently in the header region.
* **BP025** - The branding element MUST appear outside the tmux-style frame, above the status bar.
* **BP026** - Header layout and branding MUST appear consistently across all pages.

##### Navigation — Top Status Bar

* **BP027** - The top status bar MUST display clickable week numbers for all published weeks.
* **BP028** - Week numbers for unpublished weeks MUST NOT appear in the status bar.
* **BP029** - Each week number MUST link to the corresponding weekly blog post.
* **BP030** - Each week number MUST display a native browser tooltip (via `title` attribute) showing the post title on hover.
* **BP031** - The status bar MUST include a "Weeks" label implemented as a standard anchor element.
* **BP032** - The "Weeks" link MUST navigate to the Weekly Index page at `/blog/weeks/`.
* **BP033** - The "Weeks" link MUST be accessible and functional in CLI browsers.

##### Navigation — Bottom Navigation Bar

* **BP034** - The bottom navigation bar MUST appear on all pages.
* **BP035** - The bottom navigation bar MUST include links to: About (`/about/`), Weekly Index (`/blog/weeks/`), Reports (`/blog/reports/`), RSS feed, and GitHub repository.
* **BP036** - All navigation links MUST function without JavaScript.
* **BP037** - Navigation links MUST use descriptive text labels.
* **BP038** - Icons MAY accompany navigation text labels but SHALL NOT replace them.
* **BP039** - All navigation MUST be understandable in CLI browsers with visible text (no icon-only links).

##### Navigation — In-Post

* **BP040** - Each blog post MUST display a table of contents listing all major sections.
* **BP041** - The table of contents MUST appear at the top of the post content area.
* **BP042** - Each table of contents entry MUST link to the corresponding section anchor.
* **BP043** - Blog posts SHOULD display a sticky section indicator showing the current section being read (e.g., "§ Reading: Section Name").
* **BP044** - If implemented, the sticky section indicator MUST NOT require JavaScript.
* **BP045** - Blog posts MUST display navigation links to the previous week's post (when applicable).
* **BP046** - Blog posts MUST display navigation links to the next week's post (when applicable).
* **BP047** - The first weekly post MUST NOT display a previous week link.
* **BP048** - The latest weekly post MUST NOT display an active next week link.

##### Content Pages

* **BP049** - The system SHALL provide an About page accessible at `/about/`.
* **BP050** - The About page MUST include project description and author information.
* **BP051** - The system SHALL provide a Weekly Index page accessible at `/blog/weeks/`.
* **BP052** - The Weekly Index MUST list all 52 weeks with status indicators (completed, in-progress, upcoming).
* **BP053** - Completed weeks MUST display their title and link to the corresponding post.
* **BP054** - Upcoming weeks MUST be visually distinguished and not linked.
* **BP055** - The system SHALL provide a Reports section accessible at `/blog/reports/`.
* **BP056** - The Reports index MUST list all published monthly and quarterly reports with links.
* **BP057** - The system SHALL provide a Community page accessible at `/community/`.
* **BP058** - The Community page SHALL fetch and display public GitHub repositories tagged with the "52vibes" topic.
* **BP059** - The Community page MAY use embedded JavaScript to fetch repository data from the GitHub API.
* **BP060** - Each displayed repository MUST show: name (linked to GitHub), description, and star count.
* **BP061** - The Community page MUST display a fallback message with link to the GitHub topics page if API requests fail.
* **BP062** - The Community page MUST display a meaningful message when no community repositories exist.
* **BP063** - The Community page SHOULD implement client-side caching of API results to minimize requests.
* **BP064** - The system SHALL provide a blog index page accessible at `/blog/`.
* **BP065** - The blog index MUST list all published posts with: title, publication date, and summary.

##### Blog Post Structure

* **BP066** - Weekly blog posts MUST be accessible at URLs matching the pattern `/blog/week-XX-<slug>/` where XX is the zero-padded week number.
* **BP067** - Monthly report posts MUST be accessible at URLs matching the pattern `/blog/reports/YYYY-MM/`.
* **BP068** - Quarterly report posts MUST be accessible at URLs matching the pattern `/blog/reports/YYYY-qN/` where N is the quarter number (1–4).
* **BP069** - Each blog post MUST display the post title.
* **BP070** - Each blog post MUST display the publication date.
* **BP071** - Each blog post MUST display the estimated reading time.
* **BP072** - Each blog post MUST display a quarter/theme indicator (e.g., "Q1: Agentic Infrastructure").
* **BP073** - Each blog post MUST include a link to the corresponding session log on the GitHub Wiki.
* **BP074** - Each blog post MUST include a link to the corresponding GitHub repository or code artifacts.
* **BP075** - Each blog post MUST include a link to a dedicated GitHub Discussion thread for reader comments.
* **BP076** - The GitHub Discussion link MUST open the specific discussion thread for that post, not the general discussions page.

##### Content Authoring

* **BP077** - Blog posts MUST be authored in Markdown format.
* **BP078** - The system SHALL render Markdown content to semantic HTML.
* **BP079** - Code blocks MUST display syntax highlighting appropriate to the specified programming language.
* **BP080** - Syntax highlighting MUST render correctly in both dark and light themes.
* **BP081** - The system MUST support callout/admonition blocks using styled blockquote syntax for tips, warnings, and notes.
* **BP082** - Different callout types MUST be visually distinguishable.
* **BP083** - The system MUST support local preview of the site during development.
* **BP084** - Local preview MUST reflect content changes without requiring full site rebuild.

##### Accessibility

* **BP085** - All pages MUST use semantic HTML5 elements: `<header>`, `<nav>`, `<main>`, `<article>`, `<aside>`, `<footer>`.
* **BP086** - All `<img>` elements MUST include non-empty, descriptive `alt` attributes.
* **BP087** - All pages MUST include a "skip to content" link as the first focusable element.
* **BP088** - The "skip to content" link MUST transfer focus to the main content area when activated.
* **BP089** - All interactive elements MUST be reachable and operable using keyboard only.
* **BP090** - All focusable elements MUST display visible focus indicators.
* **BP091** - Color contrast ratios MUST meet WCAG 2.1 AA standards (4.5:1 for normal text, 3:1 for large text) in both themes.
* **BP092** - The rendered HTML MUST maintain a logical reading order when CSS is not applied.
* **BP093** - Content MUST NOT rely on CSS for meaning or sequence.

##### SEO and Discovery

* **BP094** - The system SHALL generate an RSS or Atom feed listing all published blog posts.
* **BP095** - The feed MUST be accessible at a standard path (e.g., `/index.xml` or `/blog/index.xml`).
* **BP096** - Each page MUST include a `<title>` element containing the page or post title.
* **BP097** - Each page MUST include a `<meta name="description">` tag with relevant content description.
* **BP098** - Each page MUST include Open Graph meta tags: `og:title`, `og:description`, `og:image`, `og:url`, `og:type`.
* **BP099** - Blog post pages MUST set `og:type` to "article".
* **BP100** - Each page MUST include Twitter Card meta tags: `twitter:card`, `twitter:title`, `twitter:description`, `twitter:image`.
* **BP101** - The `twitter:card` value MUST be set to "summary_large_image".
* **BP102** - The system SHALL generate a sitemap at `/sitemap.xml`.
* **BP103** - The sitemap MUST include all blog posts, static pages, and report pages.
* **BP104** - The sitemap MUST conform to the Sitemap XML protocol specification.
* **BP105** - Blog posts MUST include JSON-LD structured data conforming to Schema.org Article schema.
* **BP106** - The system SHALL generate social card images for each post.
* **BP107** - Social card images MUST display: week number, post title, and quarter theme.
* **BP108** - Social card images MUST use a consistent template design across all posts.

##### Analytics

* **BP109** - The system SHOULD integrate Cloudflare Analytics for traffic measurement.
* **BP110** - Analytics collection MUST NOT require client-side JavaScript execution.

---

### crush-export

The crush-export tool is a command-line utility that processes AI agent session data from SQLite database and generates structured wiki-ready markdown documents.

#### SPECIFICATIONS

* **CX001** - The tool SHALL process session data from the `.crush/crush.db` SQLite database.
* **CX002** - The tool SHALL generate wiki-ready markdown documents as output.
* **CX003** - Output documents MUST include a "Lessons Learned" section.
* **CX004** - Output documents MUST include session statistics.
* **CX005** - Output documents MUST include key conversation excerpts.
* **CX006** - Output documents MUST include the full conversation log.
* **CX007** - Full conversation logs MAY use collapsible sections for readability.
* **CX008** - The tool MUST extract session duration from session data.
* **CX009** - The tool MUST extract message count from session data.
* **CX010** - The tool MUST extract files created/modified count from session data.
* **CX011** - The tool MUST extract error count from session data.
* **CX012** - Output files MUST use Markdown format compatible with GitHub Wiki rendering.
* **CX013** - The tool SHALL support listing all available sessions via `-l` flag.
* **CX014** - The tool SHALL support exporting a specific session via `-session` flag.

---

### Session Log Synchronization

Session Log Synchronization is an automated workflow that publishes session logs to the GitHub Wiki, maintaining separation from the main blog build process.

#### SPECIFICATIONS

* **SL001** - Session logs MUST be published to the GitHub Wiki associated with the blog repository.
* **SL002** - Session log content MUST be stored separately from the blog content to enable independent updates.
* **SL003** - Session log updates MUST NOT trigger a blog site rebuild.
* **SL004** - The system SHALL provide a GitHub Actions workflow to synchronize session log files to the wiki.
* **SL005** - The synchronization workflow MUST trigger on push events affecting the `sessions/` directory.
* **SL006** - Session log file format in the source repository MUST be Markdown.

---

## DEPLOYMENT & INFRASTRUCTURE

These requirements specify the build, deployment, and infrastructure configuration for the 52vibes platform.

### Build System

* **DI001** - The blog MUST be built using Hugo static site generator without any Node.js or NPM dependencies.
* **DI002** - The Hugo version MUST be pinned in the repository (via `.hugo-version` file or equivalent) to ensure reproducible builds.
* **DI003** - The build process MUST complete successfully using only Hugo and standard Go tooling.
* **DI004** - All theme assets, templates, and configurations MUST be self-contained within the repository.
* **DI005** - The build MUST NOT rely on external package registries (NPM, yarn, etc.) at build time.

### Local Development

* **DI006** - The system MUST support local development and preview using `hugo server`.
* **DI007** - Local preview MUST provide hot-reload functionality for content and template changes.
* **DI008** - Local preview MUST render the site identically to production (excluding CDN-specific features).
* **DI009** - Documentation MUST include instructions for setting up local development environment.

### Production Deployment

* **DI010** - Production deployment SHALL use Cloudflare Pages connected to the GitHub repository.
* **DI011** - The domain `52vibes.dev` SHALL be managed through Cloudflare DNS.
* **DI012** - Cloudflare Pages MUST be configured to build on push to the `main` branch.
* **DI013** - Build commands and output directory MUST be configured in Cloudflare Pages dashboard or `wrangler.toml`.

### Source Control

* **DI014** - The Git repository SHALL serve as the single source of truth for all content and configuration.
* **DI015** - No additional backup system is REQUIRED; Git history provides version control and recovery capability.
* **DI016** - All generated assets (social cards, etc.) SHOULD be deterministically reproducible from source.

---

## NON-FUNCTIONAL REQUIREMENTS

These requirements specify performance, availability, and quality attributes for the platform.

### Core Web Vitals

* **NF001** - Largest Contentful Paint (LCP) MUST be ≤2.5 seconds on mobile connections (4G).
* **NF002** - Cumulative Layout Shift (CLS) MUST be ≤0.1.
* **NF003** - Time to First Byte (TTFB) MUST be ≤800ms for cached responses from CDN edge.
* **NF004** - First Contentful Paint (FCP) SHOULD be ≤1.8 seconds.
* **NF005** - Total Blocking Time (TBT) SHOULD be ≤200ms.

### Availability

* **NF006** - The production site SHALL maintain 99.9% availability, consistent with Cloudflare Pages SLA.
* **NF007** - The site MUST remain accessible during Cloudflare Pages deployments (zero-downtime deployment).
* **NF008** - Failed deployments MUST NOT affect the currently live version of the site.

### Scalability

* **NF009** - The site MUST handle traffic spikes without degradation, leveraging Cloudflare's global CDN.
* **NF010** - Static assets MUST be served from CDN edge locations globally.
* **NF011** - No server-side compute is REQUIRED; the site MUST function as purely static files.

### Caching

* **NF012** - Static assets (CSS, JS, fonts, images) MUST be served with cache headers allowing CDN edge caching.
* **NF013** - HTML pages SHOULD use appropriate cache headers balancing freshness and performance.
* **NF014** - Cache invalidation MUST occur automatically upon successful deployment.

### Page Weight

* **NF015** - The total page weight for the blog index SHOULD NOT exceed 500KB (compressed).
* **NF016** - Individual blog posts SHOULD NOT exceed 1MB total weight (excluding embedded media).
* **NF017** - Critical CSS SHOULD be inlined or loaded with high priority to minimize render-blocking.

---

## SECURITY REQUIREMENTS

These requirements specify security controls and configurations for the platform.

### Transport Security

* **SC001** - All traffic MUST be served over HTTPS; HTTP requests MUST redirect to HTTPS (301 permanent redirect).
* **SC002** - HTTP Strict Transport Security (HSTS) MUST be enabled with a minimum max-age of 31536000 seconds (1 year).
* **SC003** - HSTS SHOULD include the `includeSubDomains` directive.
* **SC004** - The site SHOULD be submitted to the HSTS preload list.

### Content Security Policy

* **SC005** - The site MUST serve a Content-Security-Policy header.
* **SC006** - CSP `default-src` directive MUST be set to `'self'`.
* **SC007** - CSP `script-src` directive MUST allow `'self'` and use nonces or hashes for any inline scripts (theme toggle).
* **SC008** - CSP `style-src` directive MUST allow `'self'` and MAY allow `'unsafe-inline'` for critical CSS if required.
* **SC009** - CSP `img-src` directive MUST allow `'self'`, `data:` (for inline images), and `https:` (for external images if needed).
* **SC010** - CSP `font-src` directive MUST allow `'self'` and font CDN origins (e.g., `https://fonts.gstatic.com`) if web fonts are externally hosted.
* **SC011** - CSP `connect-src` directive MUST allow `'self'` and `https://api.github.com` for the Community page API calls.
* **SC012** - CSP MUST NOT allow `'unsafe-eval'` in any directive.
* **SC013** - CSP violations SHOULD be reported via `report-uri` or `report-to` directive to a logging endpoint.

### Security Headers

* **SC014** - The `X-Frame-Options` header MUST be set to `DENY` to prevent clickjacking.
* **SC015** - The `X-Content-Type-Options` header MUST be set to `nosniff` to prevent MIME-type sniffing.
* **SC016** - The `Referrer-Policy` header MUST be set to `strict-origin-when-cross-origin`.
* **SC017** - The `Permissions-Policy` header SHOULD restrict unnecessary browser features (e.g., `geolocation=(), microphone=(), camera=()`).
* **SC018** - The `X-XSS-Protection` header MAY be omitted (deprecated) or set to `0` as CSP provides superior protection.

### Third-Party Resources

* **SC019** - External JavaScript dependencies MUST NOT be loaded from third-party CDNs; all scripts MUST be self-hosted.
* **SC020** - Web fonts MAY be loaded from Google Fonts CDN or MUST be self-hosted; if externally loaded, Subresource Integrity (SRI) SHOULD be used where supported.
* **SC021** - The GitHub API calls on the Community page MUST use the unauthenticated public API to avoid credential exposure.
* **SC022** - No API keys or secrets SHALL be embedded in client-side code.

### Input Validation

* **SC023** - User-generated input (search queries, URL parameters) MUST be properly escaped before rendering to prevent XSS.
* **SC024** - The site MUST NOT execute or evaluate user-provided content.

---

## TRACEABILITY MATRIX

| Need ID | Requirement ID(s) |
|---------|-------------------|
| N001 | BP001 |
| N002 | BP006 |
| N003 | BP007, BP008 |
| N004 | BP005 |
| N005 | BP003, BP004 |
| N006 | BP009, BP010, BP011 |
| N007 | BP012, BP013 |
| N008 | BP014, BP015, BP016 |
| N009 | BP017, BP018, BP019, BP020 |
| N010 | BP021, BP022, BP023 |
| N011 | BP013 |
| N012 | BP027, BP028, BP029 |
| N013 | BP030 |
| N014 | BP031, BP032, BP033 |
| N015 | BP034, BP035, BP036 |
| N016 | BP037, BP038, BP039 |
| N017 | BP040, BP041, BP042 |
| N018 | BP043, BP044 |
| N019 | BP049, BP050 |
| N020 | BP051, BP052, BP053, BP054 |
| N021 | BP055, BP056 |
| N022 | BP057, BP058, BP059 |
| N023 | BP064, BP065 |
| N024 | BP066 |
| N025 | BP067 |
| N026 | BP068 |
| N027 | BP069, BP070, BP071, BP072 |
| N028 | BP045, BP046, BP047, BP048 |
| N029 | BP073 |
| N030 | BP074 |
| N031 | SL001, SL002 |
| N032 | CX003, CX004, CX005, CX006, CX007 |
| N033 | SL002, SL003 |
| N034 | SL004, SL005, SL006 |
| N035 | CX001, CX002, CX012, CX013, CX014 |
| N036 | CX008, CX009, CX010, CX011 |
| N037 | BP094, BP095 |
| N038 | BP096, BP097 |
| N039 | BP098, BP099 |
| N040 | BP100, BP101 |
| N041 | BP102, BP103, BP104 |
| N042 | BP105 |
| N043 | BP106, BP107, BP108 |
| N044 | BP075 |
| N045 | BP076 |
| N046 | BP085 |
| N047 | BP086 |
| N048 | BP087, BP088 |
| N049 | BP089, BP090 |
| N050 | BP091 |
| N051 | BP092, BP093 |
| N052 | BP077, BP078 |
| N053 | BP079, BP080 |
| N054 | BP081, BP082 |
| N055 | BP083, BP084 |
| N056 | BP109, BP110 |
| N057 | BP058 |
| N058 | BP060 |
| N059 | BP061 |
| N060 | BP062 |
| N061 | BP063 |
| N062 | BP024, BP025 |
| N063 | BP026 |

---

## REFERENCES

* RFC 2119 — Key words for use in RFCs to Indicate Requirement Levels
* Hugo Static Site Generator Documentation — https://gohugo.io/documentation/
* Cloudflare Pages Documentation — https://developers.cloudflare.com/pages/
* Cloudflare DNS Documentation — https://developers.cloudflare.com/dns/
* Gruvbox Color Palette — https://github.com/morhetz/gruvbox
* Schema.org Article Specification — https://schema.org/Article
* Open Graph Protocol — https://ogp.me/
* Twitter Cards Documentation — https://developer.twitter.com/en/docs/twitter-for-websites/cards
* Sitemap Protocol — https://www.sitemaps.org/protocol.html
* WCAG 2.1 Guidelines — https://www.w3.org/WAI/WCAG21/quickref/
* Google Core Web Vitals — https://web.dev/vitals/
* Content Security Policy (CSP) — https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP
* HSTS Specification (RFC 6797) — https://datatracker.ietf.org/doc/html/rfc6797
* OWASP Secure Headers Project — https://owasp.org/www-project-secure-headers/
* Permissions-Policy — https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy
* Crush AI Agent Tool — Session file format and location conventions
